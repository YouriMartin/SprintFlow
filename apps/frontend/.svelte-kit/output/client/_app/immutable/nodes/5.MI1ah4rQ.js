import{f as J,e as O,a as c,s as Q,t as z}from"../chunks/paUPhQKv.js";import{f as T,o as V,q as D,g as s,r as W,u as i,k as a,h as d,v as r,s as l}from"../chunks/CR4mJNBN.js";import{i as E}from"../chunks/CAnKmzBQ.js";import{b as f,r as g}from"../chunks/DkanCsHN.js";import{g as A}from"../chunks/C6jZLuX-.js";import{a as B}from"../chunks/CfpsT7fc.js";var X=J('<div class="error-banner svelte-g40i6i" role="alert"> </div>'),Y=J(`<div class="setup-page svelte-g40i6i"><div class="setup-card svelte-g40i6i"><div class="setup-header svelte-g40i6i"><div class="logo svelte-g40i6i"><div class="logo-icon svelte-g40i6i">SF</div> <span class="logo-text svelte-g40i6i">SprintFlow</span></div> <h1 class="svelte-g40i6i">Bienvenue sur SprintFlow</h1> <p class="subtitle svelte-g40i6i">Créez votre compte administrateur pour commencer à utiliser l'application.</p></div> <form class="setup-form svelte-g40i6i"><!> <div class="field svelte-g40i6i"><label for="name" class="svelte-g40i6i">Nom complet</label> <input id="name" type="text" placeholder="Jean Dupont" autocomplete="name" required class="svelte-g40i6i"/></div> <div class="field svelte-g40i6i"><label for="email" class="svelte-g40i6i">Adresse email</label> <input id="email" type="email" placeholder="admin@example.com" autocomplete="email" required class="svelte-g40i6i"/></div> <div class="field svelte-g40i6i"><label for="password" class="svelte-g40i6i">Mot de passe</label> <input id="password" type="password" placeholder="Minimum 8 caractères" autocomplete="new-password" required class="svelte-g40i6i"/></div> <div class="field svelte-g40i6i"><label for="confirmPassword" class="svelte-g40i6i">Confirmer le mot de passe</label> <input id="confirmPassword" type="password" placeholder="Répétez votre mot de passe" autocomplete="new-password" required class="svelte-g40i6i"/></div> <button type="submit" class="submit-btn svelte-g40i6i"><!></button></form></div></div>`);function ae(N,R){T(R,!0);let m=d(""),n=d(""),v=d(""),b=d(""),p=d(""),o=d(!1);V(async()=>{try{const{required:e}=await B.getSetupStatus();e||A("/")}catch{}});function U(){return s(m).trim()?s(n).trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(s(n))?s(v).length<8?"Le mot de passe doit contenir au moins 8 caractères.":s(v)!==s(b)?"Les mots de passe ne correspondent pas.":"":"L'adresse email est invalide.":"L'adresse email est requise.":"Le nom complet est requis."}async function j(e){e.preventDefault(),l(p,"");const t=U();if(t){l(p,t,!0);return}l(o,!0);try{await B.createSetup({name:s(m).trim(),email:s(n).trim(),password:s(v)}),A("/")}catch(u){l(p,u instanceof Error?u.message:"Une erreur est survenue.",!0)}finally{l(o,!1)}}var _=Y(),P=a(_),w=i(a(P),2),k=a(w);{var G=e=>{var t=X(),u=a(t,!0);r(t),D(()=>Q(u,s(p))),c(e,t)};E(k,e=>{s(p)&&e(G)})}var h=i(k,2),y=i(a(h),2);g(y),r(h);var x=i(h,2),q=i(a(x),2);g(q),r(x);var S=i(x,2),L=i(a(S),2);g(L),r(S);var C=i(S,2),F=i(a(C),2);g(F),r(C);var M=i(C,2),H=a(M);{var I=e=>{var t=z("Création en cours…");c(e,t)},K=e=>{var t=z("Créer le compte administrateur");c(e,t)};E(H,e=>{s(o)?e(I):e(K,!1)})}r(M),r(w),r(P),r(_),D(()=>{y.disabled=s(o),q.disabled=s(o),L.disabled=s(o),F.disabled=s(o),M.disabled=s(o)}),O("submit",w,j),f(y,()=>s(m),e=>l(m,e)),f(q,()=>s(n),e=>l(n,e)),f(L,()=>s(v),e=>l(v,e)),f(F,()=>s(b),e=>l(b,e)),c(N,_),W()}export{ae as component};
