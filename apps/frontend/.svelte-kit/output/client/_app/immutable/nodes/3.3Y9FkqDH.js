import{d as ge,f as _,a as n,e as zt,s as f,c as Mt}from"../chunks/paUPhQKv.js";import{f as ye,h as M,j as nt,z as he,g as t,s as c,o as Ee,y as mt,k as r,u as a,r as De,v as e,w as Ht,x as Vt,q as C,A as Wt}from"../chunks/CR4mJNBN.js";import{i as A}from"../chunks/CAnKmzBQ.js";import{E as H,U as V,b as et,e as B,i as ct,s as pt}from"../chunks/B7Xa6XnF.js";import{r as gt,b as rt}from"../chunks/DkanCsHN.js";import{b as yt}from"../chunks/DODDj8bX.js";import{p as we}from"../chunks/B_9wCMUX.js";import{a as W}from"../chunks/CfpsT7fc.js";import{M as Jt}from"../chunks/BmKr277m.js";var Se=_('<span class="project-name svelte-2t0dr"> </span>'),xe=_('<div class="loading svelte-2t0dr">Loading...</div>'),Ie=_('<div class="error svelte-2t0dr"> </div>'),Ue=_('<p class="no-stories svelte-2t0dr">No user stories in this epic</p>'),Ne=_('<span class="story-description svelte-2t0dr"> </span>'),Oe=_('<div class="story-card svelte-2t0dr"><div class="story-info svelte-2t0dr"><span class="story-title svelte-2t0dr"> </span> <!></div> <div class="story-meta svelte-2t0dr"><span> </span> <span> </span> <button class="btn btn-sm btn-danger-ghost svelte-2t0dr">Delete</button></div></div>'),Ce=_('<div class="stories-list svelte-2t0dr"><!></div>'),Pe=_('<div class="epic-group svelte-2t0dr"><div class="epic-header svelte-2t0dr"><div class="epic-header-left svelte-2t0dr"><span class="collapse-icon svelte-2t0dr"> </span> <h2 class="epic-title svelte-2t0dr"> </h2> <span> </span> <span class="story-count svelte-2t0dr"> </span></div> <div class="epic-header-right svelte-2t0dr"><button class="btn btn-sm btn-ghost svelte-2t0dr">+ Story</button> <button class="btn btn-sm btn-danger-ghost svelte-2t0dr">Delete</button></div></div> <!></div>'),ke=_('<span class="story-description svelte-2t0dr"> </span>'),Me=_('<div class="story-card svelte-2t0dr"><div class="story-info svelte-2t0dr"><span class="story-title svelte-2t0dr"> </span> <!></div> <div class="story-meta svelte-2t0dr"><span> </span> <span> </span> <button class="btn btn-sm btn-danger-ghost svelte-2t0dr">Delete</button></div></div>'),je=_('<div class="epic-group unassigned svelte-2t0dr"><div class="epic-header svelte-2t0dr"><div class="epic-header-left svelte-2t0dr"><h2 class="epic-title svelte-2t0dr">Unassigned Stories</h2> <span class="story-count svelte-2t0dr"> </span></div></div> <div class="stories-list svelte-2t0dr"></div></div>'),Te=_('<div class="empty-state svelte-2t0dr"><p class="svelte-2t0dr">No epics or user stories yet.</p> <p class="svelte-2t0dr">Create an epic to start organizing your backlog.</p></div>'),$e=_('<div class="backlog-content"><!> <!> <!></div>'),Ae=_("<option> </option>"),Le=_('<form class="form svelte-2t0dr"><div class="form-group svelte-2t0dr"><label for="epic-title" class="svelte-2t0dr">Title</label> <input id="epic-title" type="text" required placeholder="Enter epic title" class="svelte-2t0dr"/></div> <div class="form-group svelte-2t0dr"><label for="epic-description" class="svelte-2t0dr">Description</label> <textarea id="epic-description" placeholder="Enter epic description" rows="3" class="svelte-2t0dr"></textarea></div> <div class="form-row svelte-2t0dr"><div class="form-group svelte-2t0dr"><label for="epic-start-date" class="svelte-2t0dr">Start Date</label> <input id="epic-start-date" type="date" required class="svelte-2t0dr"/></div> <div class="form-group svelte-2t0dr"><label for="epic-end-date" class="svelte-2t0dr">End Date</label> <input id="epic-end-date" type="date" required class="svelte-2t0dr"/></div></div> <div class="form-group svelte-2t0dr"><label for="epic-status" class="svelte-2t0dr">Status</label> <select id="epic-status" class="svelte-2t0dr"></select></div> <div class="form-actions svelte-2t0dr"><button type="button" class="btn btn-secondary svelte-2t0dr">Cancel</button> <button type="submit" class="btn btn-primary svelte-2t0dr">Create Epic</button></div></form>'),Re=_("<option> </option>"),Fe=_("<option> </option>"),qe=_("<option> </option>"),Ge=_('<form class="form svelte-2t0dr"><div class="form-group svelte-2t0dr"><label for="story-title" class="svelte-2t0dr">Title</label> <input id="story-title" type="text" required placeholder="As a user, I want to..." class="svelte-2t0dr"/></div> <div class="form-group svelte-2t0dr"><label for="story-description" class="svelte-2t0dr">Description</label> <textarea id="story-description" placeholder="Enter story description" rows="3" class="svelte-2t0dr"></textarea></div> <div class="form-group svelte-2t0dr"><label for="story-epic" class="svelte-2t0dr">Epic</label> <select id="story-epic" class="svelte-2t0dr"><option>No Epic</option><!></select></div> <div class="form-row svelte-2t0dr"><div class="form-group svelte-2t0dr"><label for="story-status" class="svelte-2t0dr">Status</label> <select id="story-status" class="svelte-2t0dr"></select></div> <div class="form-group svelte-2t0dr"><label for="story-priority" class="svelte-2t0dr">Priority</label> <select id="story-priority" class="svelte-2t0dr"></select></div></div> <div class="form-actions svelte-2t0dr"><button type="button" class="btn btn-secondary svelte-2t0dr">Cancel</button> <button type="submit" class="btn btn-primary svelte-2t0dr">Create User Story</button></div></form>'),Be=_('<div class="backlog-page svelte-2t0dr"><header class="page-header svelte-2t0dr"><div class="page-title svelte-2t0dr"><h1 class="svelte-2t0dr">Backlog</h1> <!></div> <div class="header-actions svelte-2t0dr"><button class="btn btn-secondary svelte-2t0dr">+ New Epic</button> <button class="btn btn-primary svelte-2t0dr">+ New User Story</button></div></header> <!></div> <!> <!>',1);function Ze(Kt,Qt){ye(Qt,!0);const ut="00000000-0000-0000-0000-000000000001";let st=M(""),ht=M(null),J=M(nt([])),Et=M(nt([])),Dt=M(!0),L=M(null),_t=nt({}),at=M(!1),it=M(!1),Xt=M(null),x=M(nt({title:"",description:"",startDate:new Date().toISOString().split("T")[0],endDate:new Date(Date.now()+720*60*60*1e3).toISOString().split("T")[0],status:H.PLANNED,isVisibleInRoadmap:!0,projectId:""})),I=M(nt({title:"",description:"",status:et.TODO,priority:V.MEDIUM,epicId:void 0}));async function lt(){try{c(Dt,!0),c(L,null);const[s,l,p]=await Promise.all([W.getProject(t(st)),W.getEpics(),W.getUserStories()]);c(ht,s,!0),c(J,l.filter(m=>m.projectId===t(st)),!0);const g=new Set(t(J).map(m=>m.id));c(Et,p.filter(m=>m.epicId===null||m.epicId===void 0||g.has(m.epicId)),!0)}catch(s){c(L,s instanceof Error?s.message:"Failed to load data",!0)}finally{c(Dt,!1)}}function Yt(){const s=new Map;s.set(null,[]);for(const l of t(J))s.set(l.id,[]);for(const l of t(Et)){const p=l.epicId??null,g=s.get(p)??[];g.push(l),s.set(p,g)}return s}function Zt(s){_t[s]=!_t[s]}function te(){c(x,{title:"",description:"",startDate:new Date().toISOString().split("T")[0],endDate:new Date(Date.now()+720*60*60*1e3).toISOString().split("T")[0],status:H.PLANNED,isVisibleInRoadmap:!0,projectId:t(st)},!0),c(at,!0)}function jt(s=null){c(Xt,s,!0),c(I,{title:"",description:"",status:et.TODO,priority:V.MEDIUM,epicId:s??void 0},!0),c(it,!0)}async function ee(){try{await W.createEpic(t(x),ut),c(at,!1),await lt()}catch(s){c(L,s instanceof Error?s.message:"Failed to create epic",!0)}}async function re(){try{await W.createUserStory(t(I),ut),c(it,!1),await lt()}catch(s){c(L,s instanceof Error?s.message:"Failed to create user story",!0)}}async function se(s){if(confirm("Are you sure you want to delete this epic?"))try{await W.deleteEpic(s,ut),await lt()}catch(l){c(L,l instanceof Error?l.message:"Failed to delete epic",!0)}}async function Tt(s){if(confirm("Are you sure you want to delete this user story?"))try{await W.deleteUserStory(s,ut),await lt()}catch(l){c(L,l instanceof Error?l.message:"Failed to delete user story",!0)}}function $t(s){switch(s){case et.TODO:return"status-todo";case et.IN_PROGRESS:return"status-in-progress";case et.DONE:return"status-done";default:return""}}function At(s){switch(s){case V.LOW:return"priority-low";case V.MEDIUM:return"priority-medium";case V.HIGH:return"priority-high";case V.URGENT:return"priority-urgent";default:return""}}function ae(s){switch(s){case H.PLANNED:return"epic-planned";case H.IN_PROGRESS:return"epic-in-progress";case H.COMPLETED:return"epic-completed";case H.CANCELLED:return"epic-cancelled";default:return""}}he(()=>we.subscribe(l=>{const p=l.params.id;p&&p!==t(st)&&(c(st,p,!0),lt())})),Ee(()=>{});let Lt=Wt(Yt);var Rt=Be(),wt=mt(Rt),St=r(wt),xt=r(St),ie=a(r(xt),2);{var le=s=>{var l=Se(),p=r(l,!0);e(l),C(()=>f(p,t(ht).name)),n(s,l)};A(ie,s=>{t(ht)&&s(le)})}e(xt);var Ft=a(xt,2),qt=r(Ft);qt.__click=te;var oe=a(qt,2);oe.__click=()=>jt(null),e(Ft),e(St);var ve=a(St,2);{var de=s=>{var l=xe();n(s,l)},ne=s=>{var l=Mt(),p=mt(l);{var g=y=>{var D=Ie(),U=r(D,!0);e(D),C(()=>f(U,t(L))),n(y,D)},m=y=>{var D=$e(),U=r(D);B(U,17,()=>t(J),b=>b.id,(b,d)=>{const h=Wt(()=>t(Lt).get(t(d).id)??[]);var P=Pe(),N=r(P);N.__click=()=>Zt(t(d).id);var v=r(N),w=r(v),i=r(w,!0);e(w);var u=a(w,2),o=r(u,!0);e(u);var E=a(u,2),S=r(E,!0);e(E);var F=a(E,2),T=r(F);e(F),e(v);var Q=a(v,2),X=r(Q);X.__click=k=>{k.stopPropagation(),jt(t(d).id)};var ot=a(X,2);ot.__click=k=>{k.stopPropagation(),se(t(d).id)},e(Q),e(N);var It=a(N,2);{var Ut=k=>{var q=Ce(),Y=r(q);{var Nt=G=>{var tt=Ue();n(G,tt)},Z=G=>{var tt=Mt(),z=mt(tt);B(z,17,()=>t(h),$=>$.id,($,O)=>{var Ot=Oe(),Ct=r(Ot),Pt=r(Ct),pe=r(Pt,!0);e(Pt);var ue=a(Pt,2);{var _e=vt=>{var dt=Ne(),kt=r(dt,!0);e(dt),C(()=>f(kt,t(O).description)),n(vt,dt)};A(ue,vt=>{t(O).description&&vt(_e)})}e(Ct);var Bt=a(Ct,2),ft=r(Bt),fe=r(ft,!0);e(ft);var bt=a(ft,2),be=r(bt,!0);e(bt);var me=a(bt,2);me.__click=()=>Tt(t(O).id),e(Bt),e(Ot),C((vt,dt,kt)=>{f(pe,t(O).title),pt(ft,1,`badge ${vt??""}`,"svelte-2t0dr"),f(fe,dt),pt(bt,1,`badge ${kt??""}`,"svelte-2t0dr"),f(be,t(O).priority)},[()=>$t(t(O).status),()=>t(O).status.replace("_"," "),()=>At(t(O).priority)]),n($,Ot)}),n(G,tt)};A(Y,G=>{t(h).length===0?G(Nt):G(Z,!1)})}e(q),n(k,q)};A(It,k=>{_t[t(d).id]||k(Ut)})}e(P),C((k,q)=>{f(i,_t[t(d).id]?">":"v"),f(o,t(d).title),pt(E,1,`epic-status ${k??""}`,"svelte-2t0dr"),f(S,q),f(T,`(${t(h).length??""})`)},[()=>ae(t(d).status),()=>t(d).status.replace("_"," ")]),n(b,P)});var j=a(U,2);B(j,17,()=>[t(Lt).get(null)??[]],ct,(b,d)=>{var h=Mt(),P=mt(h);{var N=v=>{var w=je(),i=r(w),u=r(i),o=a(r(u),2),E=r(o);e(o),e(u),e(i);var S=a(i,2);B(S,21,()=>t(d),F=>F.id,(F,T)=>{var Q=Me(),X=r(Q),ot=r(X),It=r(ot,!0);e(ot);var Ut=a(ot,2);{var k=z=>{var $=ke(),O=r($,!0);e($),C(()=>f(O,t(T).description)),n(z,$)};A(Ut,z=>{t(T).description&&z(k)})}e(X);var q=a(X,2),Y=r(q),Nt=r(Y,!0);e(Y);var Z=a(Y,2),G=r(Z,!0);e(Z);var tt=a(Z,2);tt.__click=()=>Tt(t(T).id),e(q),e(Q),C((z,$,O)=>{f(It,t(T).title),pt(Y,1,`badge ${z??""}`,"svelte-2t0dr"),f(Nt,$),pt(Z,1,`badge ${O??""}`,"svelte-2t0dr"),f(G,t(T).priority)},[()=>$t(t(T).status),()=>t(T).status.replace("_"," "),()=>At(t(T).priority)]),n(F,Q)}),e(S),e(w),C(()=>f(E,`(${t(d).length??""})`)),n(v,w)};A(P,v=>{t(d).length>0&&v(N)})}n(b,h)});var R=a(j,2);{var K=b=>{var d=Te();n(b,d)};A(R,b=>{t(J).length===0&&t(Et).length===0&&b(K)})}e(D),n(y,D)};A(p,y=>{t(L)?y(g):y(m,!1)},!0)}n(s,l)};A(ve,s=>{t(Dt)?s(de):s(ne,!1)})}e(wt);var Gt=a(wt,2);Jt(Gt,{get open(){return t(at)},title:"Create New Epic",onclose:()=>c(at,!1),children:(s,l)=>{var p=Le(),g=r(p),m=a(r(g),2);gt(m),e(g);var y=a(g,2),D=a(r(y),2);Ht(D),e(y);var U=a(y,2),j=r(U),R=a(r(j),2);gt(R),e(j);var K=a(j,2),b=a(r(K),2);gt(b),e(K),e(U);var d=a(U,2),h=a(r(d),2);B(h,21,()=>Object.values(H),ct,(v,w)=>{var i=Ae(),u=r(i,!0);e(i);var o={};C(E=>{f(u,E),o!==(o=t(w))&&(i.value=(i.__value=t(w))??"")},[()=>t(w).replace("_"," ")]),n(v,i)}),e(h),e(d);var P=a(d,2),N=r(P);N.__click=()=>c(at,!1),Vt(2),e(P),e(p),zt("submit",p,v=>{v.preventDefault(),ee()}),rt(m,()=>t(x).title,v=>t(x).title=v),rt(D,()=>t(x).description,v=>t(x).description=v),rt(R,()=>t(x).startDate,v=>t(x).startDate=v),rt(b,()=>t(x).endDate,v=>t(x).endDate=v),yt(h,()=>t(x).status,v=>t(x).status=v),n(s,p)},$$slots:{default:!0}});var ce=a(Gt,2);Jt(ce,{get open(){return t(it)},title:"Create New User Story",onclose:()=>c(it,!1),children:(s,l)=>{var p=Ge(),g=r(p),m=a(r(g),2);gt(m),e(g);var y=a(g,2),D=a(r(y),2);Ht(D),e(y);var U=a(y,2),j=a(r(U),2),R=r(j);R.value=(R.__value=void 0)??"";var K=a(R);B(K,17,()=>t(J),ct,(i,u)=>{var o=Re(),E=r(o,!0);e(o);var S={};C(()=>{f(E,t(u).title),S!==(S=t(u).id)&&(o.value=(o.__value=t(u).id)??"")}),n(i,o)}),e(j),e(U);var b=a(U,2),d=r(b),h=a(r(d),2);B(h,21,()=>Object.values(et),ct,(i,u)=>{var o=Fe(),E=r(o,!0);e(o);var S={};C(F=>{f(E,F),S!==(S=t(u))&&(o.value=(o.__value=t(u))??"")},[()=>t(u).replace("_"," ")]),n(i,o)}),e(h),e(d);var P=a(d,2),N=a(r(P),2);B(N,21,()=>Object.values(V),ct,(i,u)=>{var o=qe(),E=r(o,!0);e(o);var S={};C(()=>{f(E,t(u)),S!==(S=t(u))&&(o.value=(o.__value=t(u))??"")}),n(i,o)}),e(N),e(P),e(b);var v=a(b,2),w=r(v);w.__click=()=>c(it,!1),Vt(2),e(v),e(p),zt("submit",p,i=>{i.preventDefault(),re()}),rt(m,()=>t(I).title,i=>t(I).title=i),rt(D,()=>t(I).description,i=>t(I).description=i),yt(j,()=>t(I).epicId,i=>t(I).epicId=i),yt(h,()=>t(I).status,i=>t(I).status=i),yt(N,()=>t(I).priority,i=>t(I).priority=i),n(s,p)},$$slots:{default:!0}}),n(Kt,Rt),De()}ge(["click"]);export{Ze as component};
