import{d as te,c as xt,e as Ft,a as d,f as u,s as f}from"../chunks/4Mh_maa4.js";import{p as ee,i as yt,e as re,$ as Ee,d as r,r as e,f as s,R as we,t as U,s as j,a as bt,u as De,g as t,c,o as Se,h as Xt,n as Yt,S as Zt}from"../chunks/DpUKlOTm.js";import{i as F}from"../chunks/DT90_JrZ.js";import{r as Dt,e as J,i as mt,s as gt}from"../chunks/DfndPHHs.js";import{E as $,U as tt,d as nt,b as ct,c as St}from"../chunks/B9j1F7tA.js";import{p as xe}from"../chunks/BZ6SkWNk.js";import{a as et}from"../chunks/DLoPx0KZ.js";import{s as Ie}from"../chunks/k75LQIeN.js";var ke=u('<div class="modal-backdrop svelte-ta60gp" role="dialog" aria-modal="true" aria-labelledby="modal-title"><div class="modal svelte-ta60gp"><div class="modal-header svelte-ta60gp"><h2 id="modal-title" class="modal-title svelte-ta60gp"> </h2> <button class="modal-close svelte-ta60gp" aria-label="Close modal"><span aria-hidden="true">&times;</span></button></div> <div class="modal-body svelte-ta60gp"><!></div></div></div>');function $t(It,R){ee(R,!0);function rt(C){C.key==="Escape"&&R.open&&R.onclose()}function Q(C){C.target===C.currentTarget&&R.onclose()}var at=xt();Ft("keydown",Ee,rt);var H=yt(at);{var pt=C=>{var S=ke();S.__click=Q;var X=r(S),q=r(X),B=r(q),kt=r(B,!0);e(B);var y=s(B,2);y.__click=function(...Ut){var ht;(ht=R.onclose)==null||ht.apply(this,Ut)},e(q);var m=s(q,2),Y=r(m);Ie(Y,()=>R.children??we),e(m),e(X),e(S),U(()=>f(kt,R.title)),d(C,S)};F(H,C=>{R.open&&C(pt)})}d(It,at),re()}te(["click"]);var Ue=u('<span class="project-name svelte-2t0dr"> </span>'),Ce=u('<div class="loading svelte-2t0dr">Loading...</div>'),Ne=u('<div class="error svelte-2t0dr"> </div>'),Oe=u('<p class="no-stories svelte-2t0dr">No user stories in this epic</p>'),Pe=u('<span class="story-description svelte-2t0dr"> </span>'),Me=u('<div class="story-card svelte-2t0dr"><div class="story-info svelte-2t0dr"><span class="story-title svelte-2t0dr"> </span> <!></div> <div class="story-meta svelte-2t0dr"><span> </span> <span> </span> <button class="btn btn-sm btn-danger-ghost svelte-2t0dr">Delete</button></div></div>'),Te=u('<div class="stories-list svelte-2t0dr"><!></div>'),je=u('<div class="epic-group svelte-2t0dr"><div class="epic-header svelte-2t0dr"><div class="epic-header-left svelte-2t0dr"><span class="collapse-icon svelte-2t0dr"> </span> <h2 class="epic-title svelte-2t0dr"> </h2> <span> </span> <span class="story-count svelte-2t0dr"> </span></div> <div class="epic-header-right svelte-2t0dr"><button class="btn btn-sm btn-ghost svelte-2t0dr">+ Story</button> <button class="btn btn-sm btn-danger-ghost svelte-2t0dr">Delete</button></div></div> <!></div>'),Re=u('<span class="story-description svelte-2t0dr"> </span>'),Le=u('<div class="story-card svelte-2t0dr"><div class="story-info svelte-2t0dr"><span class="story-title svelte-2t0dr"> </span> <!></div> <div class="story-meta svelte-2t0dr"><span> </span> <span> </span> <button class="btn btn-sm btn-danger-ghost svelte-2t0dr">Delete</button></div></div>'),Ae=u('<div class="epic-group unassigned svelte-2t0dr"><div class="epic-header svelte-2t0dr"><div class="epic-header-left svelte-2t0dr"><h2 class="epic-title svelte-2t0dr">Unassigned Stories</h2> <span class="story-count svelte-2t0dr"> </span></div></div> <div class="stories-list svelte-2t0dr"></div></div>'),Fe=u('<div class="empty-state svelte-2t0dr"><p class="svelte-2t0dr">No epics or user stories yet.</p> <p class="svelte-2t0dr">Create an epic to start organizing your backlog.</p></div>'),qe=u('<div class="backlog-content"><!> <!> <!></div>'),Be=u("<option> </option>"),Ge=u('<form class="form svelte-2t0dr"><div class="form-group svelte-2t0dr"><label for="epic-title" class="svelte-2t0dr">Title</label> <input id="epic-title" type="text" required placeholder="Enter epic title" class="svelte-2t0dr"/></div> <div class="form-group svelte-2t0dr"><label for="epic-description" class="svelte-2t0dr">Description</label> <textarea id="epic-description" placeholder="Enter epic description" rows="3" class="svelte-2t0dr"></textarea></div> <div class="form-row svelte-2t0dr"><div class="form-group svelte-2t0dr"><label for="epic-start-date" class="svelte-2t0dr">Start Date</label> <input id="epic-start-date" type="date" required class="svelte-2t0dr"/></div> <div class="form-group svelte-2t0dr"><label for="epic-end-date" class="svelte-2t0dr">End Date</label> <input id="epic-end-date" type="date" required class="svelte-2t0dr"/></div></div> <div class="form-group svelte-2t0dr"><label for="epic-status" class="svelte-2t0dr">Status</label> <select id="epic-status" class="svelte-2t0dr"></select></div> <div class="form-actions svelte-2t0dr"><button type="button" class="btn btn-secondary svelte-2t0dr">Cancel</button> <button type="submit" class="btn btn-primary svelte-2t0dr">Create Epic</button></div></form>'),He=u("<option> </option>"),Ve=u("<option> </option>"),ze=u("<option> </option>"),Ke=u('<form class="form svelte-2t0dr"><div class="form-group svelte-2t0dr"><label for="story-title" class="svelte-2t0dr">Title</label> <input id="story-title" type="text" required placeholder="As a user, I want to..." class="svelte-2t0dr"/></div> <div class="form-group svelte-2t0dr"><label for="story-description" class="svelte-2t0dr">Description</label> <textarea id="story-description" placeholder="Enter story description" rows="3" class="svelte-2t0dr"></textarea></div> <div class="form-group svelte-2t0dr"><label for="story-epic" class="svelte-2t0dr">Epic</label> <select id="story-epic" class="svelte-2t0dr"><option>No Epic</option><!></select></div> <div class="form-row svelte-2t0dr"><div class="form-group svelte-2t0dr"><label for="story-status" class="svelte-2t0dr">Status</label> <select id="story-status" class="svelte-2t0dr"></select></div> <div class="form-group svelte-2t0dr"><label for="story-priority" class="svelte-2t0dr">Priority</label> <select id="story-priority" class="svelte-2t0dr"></select></div></div> <div class="form-actions svelte-2t0dr"><button type="button" class="btn btn-secondary svelte-2t0dr">Cancel</button> <button type="submit" class="btn btn-primary svelte-2t0dr">Create User Story</button></div></form>'),We=u('<div class="backlog-page svelte-2t0dr"><header class="page-header svelte-2t0dr"><div class="page-title svelte-2t0dr"><h1 class="svelte-2t0dr">Backlog</h1> <!></div> <div class="header-actions svelte-2t0dr"><button class="btn btn-secondary svelte-2t0dr">+ New Epic</button> <button class="btn btn-primary svelte-2t0dr">+ New User Story</button></div></header> <!></div> <!> <!>',1);function rr(It,R){ee(R,!0);const rt="00000000-0000-0000-0000-000000000001";let Q=j(""),at=j(null),H=j(bt([])),pt=j(bt([])),C=j(!0),S=j(null),X=bt({}),q=j(!1),B=j(!1),kt=j(null),y=j(bt({title:"",description:"",startDate:new Date().toISOString().split("T")[0],endDate:new Date(Date.now()+720*60*60*1e3).toISOString().split("T")[0],status:$.PLANNED,isVisibleInRoadmap:!0,projectId:""})),m=j(bt({title:"",description:"",status:nt.TODO,priority:tt.MEDIUM,epicId:void 0}));async function Y(){try{c(C,!0),c(S,null);const[a,l,p]=await Promise.all([et.getProject(t(Q)),et.getEpics(),et.getUserStories()]);c(at,a,!0),c(H,l.filter(g=>g.projectId===t(Q)),!0);const h=new Set(t(H).map(g=>g.id));c(pt,p.filter(g=>g.epicId===null||g.epicId===void 0||h.has(g.epicId)),!0)}catch(a){c(S,a instanceof Error?a.message:"Failed to load data",!0)}finally{c(C,!1)}}function Ut(){const a=new Map;a.set(null,[]);for(const l of t(H))a.set(l.id,[]);for(const l of t(pt)){const p=l.epicId??null,h=a.get(p)??[];h.push(l),a.set(p,h)}return a}function ht(a){X[a]=!X[a]}function ae(){c(y,{title:"",description:"",startDate:new Date().toISOString().split("T")[0],endDate:new Date(Date.now()+720*60*60*1e3).toISOString().split("T")[0],status:$.PLANNED,isVisibleInRoadmap:!0,projectId:t(Q)},!0),c(q,!0)}function qt(a=null){c(kt,a,!0),c(m,{title:"",description:"",status:nt.TODO,priority:tt.MEDIUM,epicId:a??void 0},!0),c(B,!0)}async function se(){try{await et.createEpic(t(y),rt),c(q,!1),await Y()}catch(a){c(S,a instanceof Error?a.message:"Failed to create epic",!0)}}async function ie(){try{await et.createUserStory(t(m),rt),c(B,!1),await Y()}catch(a){c(S,a instanceof Error?a.message:"Failed to create user story",!0)}}async function le(a){if(confirm("Are you sure you want to delete this epic?"))try{await et.deleteEpic(a,rt),await Y()}catch(l){c(S,l instanceof Error?l.message:"Failed to delete epic",!0)}}async function Bt(a){if(confirm("Are you sure you want to delete this user story?"))try{await et.deleteUserStory(a,rt),await Y()}catch(l){c(S,l instanceof Error?l.message:"Failed to delete user story",!0)}}function Gt(a){switch(a){case nt.TODO:return"status-todo";case nt.IN_PROGRESS:return"status-in-progress";case nt.DONE:return"status-done";default:return""}}function Ht(a){switch(a){case tt.LOW:return"priority-low";case tt.MEDIUM:return"priority-medium";case tt.HIGH:return"priority-high";case tt.URGENT:return"priority-urgent";default:return""}}function oe(a){switch(a){case $.PLANNED:return"epic-planned";case $.IN_PROGRESS:return"epic-in-progress";case $.COMPLETED:return"epic-completed";case $.CANCELLED:return"epic-cancelled";default:return""}}De(()=>xe.subscribe(l=>{const p=l.params.id;p&&p!==t(Q)&&(c(Q,p,!0),Y())})),Se(()=>{});let Vt=Zt(Ut);var zt=We(),Ct=yt(zt),Nt=r(Ct),Ot=r(Nt),de=s(r(Ot),2);{var ve=a=>{var l=Ue(),p=r(l,!0);e(l),U(()=>f(p,t(at).name)),d(a,l)};F(de,a=>{t(at)&&a(ve)})}e(Ot);var Kt=s(Ot,2),Wt=r(Kt);Wt.__click=ae;var ne=s(Wt,2);ne.__click=()=>qt(null),e(Kt),e(Nt);var ce=s(Nt,2);{var pe=a=>{var l=Ce();d(a,l)},ue=a=>{var l=xt(),p=yt(l);{var h=E=>{var x=Ne(),N=r(x,!0);e(x),U(()=>f(N,t(S))),d(E,x)},g=E=>{var x=qe(),N=r(x);J(N,17,()=>t(H),b=>b.id,(b,n)=>{const w=Zt(()=>t(Vt).get(t(n).id)??[]);var M=je(),O=r(M);O.__click=()=>ht(t(n).id);var v=r(O),I=r(v),i=r(I,!0);e(I);var _=s(I,2),o=r(_,!0);e(_);var D=s(_,2),k=r(D,!0);e(D);var z=s(D,2),A=r(z);e(z),e(v);var it=s(v,2),lt=r(it);lt.__click=T=>{T.stopPropagation(),qt(t(n).id)};var ut=s(lt,2);ut.__click=T=>{T.stopPropagation(),le(t(n).id)},e(it),e(O);var Pt=s(O,2);{var Mt=T=>{var K=Te(),ot=r(K);{var Tt=W=>{var vt=Oe();d(W,vt)},dt=W=>{var vt=xt(),Z=yt(vt);J(Z,17,()=>t(w),G=>G.id,(G,P)=>{var jt=Me(),Rt=r(jt),Lt=r(Rt),fe=r(Lt,!0);e(Lt);var be=s(Lt,2);{var me=_t=>{var ft=Pe(),At=r(ft,!0);e(ft),U(()=>f(At,t(P).description)),d(_t,ft)};F(be,_t=>{t(P).description&&_t(me)})}e(Rt);var Qt=s(Rt,2),Et=r(Qt),ge=r(Et,!0);e(Et);var wt=s(Et,2),ye=r(wt,!0);e(wt);var he=s(wt,2);he.__click=()=>Bt(t(P).id),e(Qt),e(jt),U((_t,ft,At)=>{f(fe,t(P).title),gt(Et,1,`badge ${_t??""}`,"svelte-2t0dr"),f(ge,ft),gt(wt,1,`badge ${At??""}`,"svelte-2t0dr"),f(ye,t(P).priority)},[()=>Gt(t(P).status),()=>t(P).status.replace("_"," "),()=>Ht(t(P).priority)]),d(G,jt)}),d(W,vt)};F(ot,W=>{t(w).length===0?W(Tt):W(dt,!1)})}e(K),d(T,K)};F(Pt,T=>{X[t(n).id]||T(Mt)})}e(M),U((T,K)=>{f(i,X[t(n).id]?">":"v"),f(o,t(n).title),gt(D,1,`epic-status ${T??""}`,"svelte-2t0dr"),f(k,K),f(A,`(${t(w).length??""})`)},[()=>oe(t(n).status),()=>t(n).status.replace("_"," ")]),d(b,M)});var L=s(N,2);J(L,17,()=>[t(Vt).get(null)??[]],mt,(b,n)=>{var w=xt(),M=yt(w);{var O=v=>{var I=Ae(),i=r(I),_=r(i),o=s(r(_),2),D=r(o);e(o),e(_),e(i);var k=s(i,2);J(k,21,()=>t(n),z=>z.id,(z,A)=>{var it=Le(),lt=r(it),ut=r(lt),Pt=r(ut,!0);e(ut);var Mt=s(ut,2);{var T=Z=>{var G=Re(),P=r(G,!0);e(G),U(()=>f(P,t(A).description)),d(Z,G)};F(Mt,Z=>{t(A).description&&Z(T)})}e(lt);var K=s(lt,2),ot=r(K),Tt=r(ot,!0);e(ot);var dt=s(ot,2),W=r(dt,!0);e(dt);var vt=s(dt,2);vt.__click=()=>Bt(t(A).id),e(K),e(it),U((Z,G,P)=>{f(Pt,t(A).title),gt(ot,1,`badge ${Z??""}`,"svelte-2t0dr"),f(Tt,G),gt(dt,1,`badge ${P??""}`,"svelte-2t0dr"),f(W,t(A).priority)},[()=>Gt(t(A).status),()=>t(A).status.replace("_"," "),()=>Ht(t(A).priority)]),d(z,it)}),e(k),e(I),U(()=>f(D,`(${t(n).length??""})`)),d(v,I)};F(M,v=>{t(n).length>0&&v(O)})}d(b,w)});var V=s(L,2);{var st=b=>{var n=Fe();d(b,n)};F(V,b=>{t(H).length===0&&t(pt).length===0&&b(st)})}e(x),d(E,x)};F(p,E=>{t(S)?E(h):E(g,!1)},!0)}d(a,l)};F(ce,a=>{t(C)?a(pe):a(ue,!1)})}e(Ct);var Jt=s(Ct,2);$t(Jt,{get open(){return t(q)},title:"Create New Epic",onclose:()=>c(q,!1),children:(a,l)=>{var p=Ge(),h=r(p),g=s(r(h),2);Dt(g),e(h);var E=s(h,2),x=s(r(E),2);Xt(x),e(E);var N=s(E,2),L=r(N),V=s(r(L),2);Dt(V),e(L);var st=s(L,2),b=s(r(st),2);Dt(b),e(st),e(N);var n=s(N,2),w=s(r(n),2);J(w,21,()=>Object.values($),mt,(v,I)=>{var i=Be(),_=r(i,!0);e(i);var o={};U(D=>{f(_,D),o!==(o=t(I))&&(i.value=(i.__value=t(I))??"")},[()=>t(I).replace("_"," ")]),d(v,i)}),e(w),e(n);var M=s(n,2),O=r(M);O.__click=()=>c(q,!1),Yt(2),e(M),e(p),Ft("submit",p,v=>{v.preventDefault(),se()}),ct(g,()=>t(y).title,v=>t(y).title=v),ct(x,()=>t(y).description,v=>t(y).description=v),ct(V,()=>t(y).startDate,v=>t(y).startDate=v),ct(b,()=>t(y).endDate,v=>t(y).endDate=v),St(w,()=>t(y).status,v=>t(y).status=v),d(a,p)},$$slots:{default:!0}});var _e=s(Jt,2);$t(_e,{get open(){return t(B)},title:"Create New User Story",onclose:()=>c(B,!1),children:(a,l)=>{var p=Ke(),h=r(p),g=s(r(h),2);Dt(g),e(h);var E=s(h,2),x=s(r(E),2);Xt(x),e(E);var N=s(E,2),L=s(r(N),2),V=r(L);V.value=(V.__value=void 0)??"";var st=s(V);J(st,17,()=>t(H),mt,(i,_)=>{var o=He(),D=r(o,!0);e(o);var k={};U(()=>{f(D,t(_).title),k!==(k=t(_).id)&&(o.value=(o.__value=t(_).id)??"")}),d(i,o)}),e(L),e(N);var b=s(N,2),n=r(b),w=s(r(n),2);J(w,21,()=>Object.values(nt),mt,(i,_)=>{var o=Ve(),D=r(o,!0);e(o);var k={};U(z=>{f(D,z),k!==(k=t(_))&&(o.value=(o.__value=t(_))??"")},[()=>t(_).replace("_"," ")]),d(i,o)}),e(w),e(n);var M=s(n,2),O=s(r(M),2);J(O,21,()=>Object.values(tt),mt,(i,_)=>{var o=ze(),D=r(o,!0);e(o);var k={};U(()=>{f(D,t(_)),k!==(k=t(_))&&(o.value=(o.__value=t(_))??"")}),d(i,o)}),e(O),e(M),e(b);var v=s(b,2),I=r(v);I.__click=()=>c(B,!1),Yt(2),e(v),e(p),Ft("submit",p,i=>{i.preventDefault(),ie()}),ct(g,()=>t(m).title,i=>t(m).title=i),ct(x,()=>t(m).description,i=>t(m).description=i),St(L,()=>t(m).epicId,i=>t(m).epicId=i),St(w,()=>t(m).status,i=>t(m).status=i),St(O,()=>t(m).priority,i=>t(m).priority=i),d(a,p)},$$slots:{default:!0}}),d(It,zt),re()}te(["click"]);export{rr as component};
